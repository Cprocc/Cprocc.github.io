<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>逻辑回归 | ZXC&#39;Blog</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="摘要一个简单的数据判别例子">
<meta name="keywords" content="python,Kaggle,DataScience,Logistics Regression">
<meta property="og:type" content="article">
<meta property="og:title" content="逻辑回归">
<meta property="og:url" content="https://cprocc.github.io/2019/05/13/heartDisease/index.html">
<meta property="og:site_name" content="ZXC&#39;Blog">
<meta property="og:description" content="摘要一个简单的数据判别例子">
<meta property="og:image" content="https://cprocc.github.io/2019/05/13/heartDisease/output_7_1.png">
<meta property="og:image" content="https://cprocc.github.io/2019/05/13/heartDisease/output_8_1.png">
<meta property="og:image" content="https://cprocc.github.io/2019/05/13/heartDisease/output_9_0.png">
<meta property="og:image" content="https://cprocc.github.io/2019/05/13/heartDisease/output_19_0.png">
<meta property="og:image" content="https://cprocc.github.io/2019/05/13/heartDisease/output_23_0.png">
<meta property="og:updated_time" content="2019-05-13T13:27:11.747Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="逻辑回归">
<meta name="twitter:description" content="摘要一个简单的数据判别例子">
<meta name="twitter:image" content="https://cprocc.github.io/2019/05/13/heartDisease/output_7_1.png">
  
    <link rel="alternate" href="/atom.xml" title="ZXC&#39;Blog" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">ZXC&#39;Blog</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">来都来了</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://cprocc.github.io"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-heartDisease" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/05/13/heartDisease/" class="article-date">
  <time datetime="2019-05-13T06:38:15.000Z" itemprop="datePublished">2019-05-13</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/python/">python</a>►<a class="article-category-link" href="/categories/python/DateScience/">DateScience</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      逻辑回归
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>摘要<br>一个简单的数据判别例子<br><a id="more"></a><br>正文：</p>
<h2 id="逻辑回归-来自Kaggle"><a href="#逻辑回归-来自Kaggle" class="headerlink" title="逻辑回归(来自Kaggle)"></a>逻辑回归(来自Kaggle)</h2><ul>
<li>有一份医疗数据，包含各种和健康指标，以及最后一项他是否有心脏疾病。本文将数据分为两组，一组建立逻辑回归模型，另外一组用来作为测试组。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> pandas <span class="keyword">as</span> pd</div><div class="line"></div><div class="line"><span class="comment"># 读取数据，展示前五行</span></div><div class="line">data = pd.read_csv(<span class="string">'D:\zxc_E\Python-Project\DataAna\kaggle\heartDisease\heart.csv'</span>)</div><div class="line">data.head()</div></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>age</th><br>      <th>sex</th><br>      <th>cp</th><br>      <th>trestbps</th><br>      <th>chol</th><br>      <th>fbs</th><br>      <th>restecg</th><br>      <th>thalach</th><br>      <th>exang</th><br>      <th>oldpeak</th><br>      <th>slope</th><br>      <th>ca</th><br>      <th>thal</th><br>      <th>target</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>63</td><br>      <td>1</td><br>      <td>3</td><br>      <td>145</td><br>      <td>233</td><br>      <td>1</td><br>      <td>0</td><br>      <td>150</td><br>      <td>0</td><br>      <td>2.3</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>37</td><br>      <td>1</td><br>      <td>2</td><br>      <td>130</td><br>      <td>250</td><br>      <td>0</td><br>      <td>1</td><br>      <td>187</td><br>      <td>0</td><br>      <td>3.5</td><br>      <td>0</td><br>      <td>0</td><br>      <td>2</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>41</td><br>      <td>0</td><br>      <td>1</td><br>      <td>130</td><br>      <td>204</td><br>      <td>0</td><br>      <td>0</td><br>      <td>172</td><br>      <td>0</td><br>      <td>1.4</td><br>      <td>2</td><br>      <td>0</td><br>      <td>2</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>56</td><br>      <td>1</td><br>      <td>1</td><br>      <td>120</td><br>      <td>236</td><br>      <td>0</td><br>      <td>1</td><br>      <td>178</td><br>      <td>0</td><br>      <td>0.8</td><br>      <td>2</td><br>      <td>0</td><br>      <td>2</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>57</td><br>      <td>0</td><br>      <td>0</td><br>      <td>120</td><br>      <td>354</td><br>      <td>0</td><br>      <td>1</td><br>      <td>163</td><br>      <td>1</td><br>      <td>0.6</td><br>      <td>2</td><br>      <td>0</td><br>      <td>2</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看数据规模</span></div><div class="line">data.shape</div></pre></td></tr></table></figure>
<pre><code>(303, 14)
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看总体数据的大概描述，包括总和，均值等</span></div><div class="line">data.describe()</div></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>age</th><br>      <th>sex</th><br>      <th>cp</th><br>      <th>trestbps</th><br>      <th>chol</th><br>      <th>fbs</th><br>      <th>restecg</th><br>      <th>thalach</th><br>      <th>exang</th><br>      <th>oldpeak</th><br>      <th>slope</th><br>      <th>ca</th><br>      <th>thal</th><br>      <th>target</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>count</th><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>      <td>303.000000</td><br>    </tr><br>    <tr><br>      <th>mean</th><br>      <td>54.366337</td><br>      <td>0.683168</td><br>      <td>0.966997</td><br>      <td>131.623762</td><br>      <td>246.264026</td><br>      <td>0.148515</td><br>      <td>0.528053</td><br>      <td>149.646865</td><br>      <td>0.326733</td><br>      <td>1.039604</td><br>      <td>1.399340</td><br>      <td>0.729373</td><br>      <td>2.313531</td><br>      <td>0.544554</td><br>    </tr><br>    <tr><br>      <th>std</th><br>      <td>9.082101</td><br>      <td>0.466011</td><br>      <td>1.032052</td><br>      <td>17.538143</td><br>      <td>51.830751</td><br>      <td>0.356198</td><br>      <td>0.525860</td><br>      <td>22.905161</td><br>      <td>0.469794</td><br>      <td>1.161075</td><br>      <td>0.616226</td><br>      <td>1.022606</td><br>      <td>0.612277</td><br>      <td>0.498835</td><br>    </tr><br>    <tr><br>      <th>min</th><br>      <td>29.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>94.000000</td><br>      <td>126.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>71.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>    </tr><br>    <tr><br>      <th>25%</th><br>      <td>47.500000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>120.000000</td><br>      <td>211.000000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>133.500000</td><br>      <td>0.000000</td><br>      <td>0.000000</td><br>      <td>1.000000</td><br>      <td>0.000000</td><br>      <td>2.000000</td><br>      <td>0.000000</td><br>    </tr><br>    <tr><br>      <th>50%</th><br>      <td>55.000000</td><br>      <td>1.000000</td><br>      <td>1.000000</td><br>      <td>130.000000</td><br>      <td>240.000000</td><br>      <td>0.000000</td><br>      <td>1.000000</td><br>      <td>153.000000</td><br>      <td>0.000000</td><br>      <td>0.800000</td><br>      <td>1.000000</td><br>      <td>0.000000</td><br>      <td>2.000000</td><br>      <td>1.000000</td><br>    </tr><br>    <tr><br>      <th>75%</th><br>      <td>61.000000</td><br>      <td>1.000000</td><br>      <td>2.000000</td><br>      <td>140.000000</td><br>      <td>274.500000</td><br>      <td>0.000000</td><br>      <td>1.000000</td><br>      <td>166.000000</td><br>      <td>1.000000</td><br>      <td>1.600000</td><br>      <td>2.000000</td><br>      <td>1.000000</td><br>      <td>3.000000</td><br>      <td>1.000000</td><br>    </tr><br>    <tr><br>      <th>max</th><br>      <td>77.000000</td><br>      <td>1.000000</td><br>      <td>3.000000</td><br>      <td>200.000000</td><br>      <td>564.000000</td><br>      <td>1.000000</td><br>      <td>2.000000</td><br>      <td>202.000000</td><br>      <td>1.000000</td><br>      <td>6.200000</td><br>      <td>2.000000</td><br>      <td>4.000000</td><br>      <td>3.000000</td><br>      <td>1.000000</td><br>    </tr><br>  </tbody><br></table><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div></pre></td><td class="code"><pre><div class="line">data.isnull().any()</div></pre></td></tr></table></figure>
<pre><code>age         False
sex         False
cp          False
trestbps    False
chol        False
fbs         False
restecg     False
thalach     False
exang       False
oldpeak     False
slope       False
ca          False
thal        False
target      False
dtype: bool
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看数据的信息，主要是存储类型</span></div><div class="line">data.info()</div></pre></td></tr></table></figure>
<pre><code>&lt;class &apos;pandas.core.frame.DataFrame&apos;&gt;
RangeIndex: 303 entries, 0 to 302
Data columns (total 14 columns):
age         303 non-null int64
sex         303 non-null int64
cp          303 non-null int64
trestbps    303 non-null int64
chol        303 non-null int64
fbs         303 non-null int64
restecg     303 non-null int64
thalach     303 non-null int64
exang       303 non-null int64
oldpeak     303 non-null float64
slope       303 non-null int64
ca          303 non-null int64
thal        303 non-null int64
target      303 non-null int64
dtypes: float64(1), int64(13)
memory usage: 33.2 KB
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 导入数据可视化库Seaborn</span></div><div class="line"><span class="keyword">import</span> seaborn <span class="keyword">as</span> sns</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看心脏病人数</span></div><div class="line">sns.countplot(x = <span class="string">'target'</span>, data = data)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x217ee040ef0&gt;
</code></pre><p><img src="/2019/05/13/heartDisease/output_7_1.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 查看男女比例</span></div><div class="line">sns.countplot(x = <span class="string">'sex'</span>, data = data, palette=<span class="string">'colorblind'</span>)</div></pre></td></tr></table></figure>
<pre><code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x217ef06aa90&gt;
</code></pre><p><img src="/2019/05/13/heartDisease/output_8_1.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">import</span> matplotlib <span class="keyword">as</span> plt</div><div class="line"></div><div class="line"><span class="comment"># 查看所有数据项之间的相关性，颜色越深相关性越强</span></div><div class="line">fig, ax = plt.pyplot.subplots(figsize = (<span class="number">11</span>, <span class="number">8</span>))</div><div class="line">sns.heatmap(data.corr(), annot=<span class="keyword">True</span>, cmap = <span class="string">'Blues'</span>, ax=ax)</div><div class="line">plt.pyplot.show()</div></pre></td></tr></table></figure>
<p><img src="/2019/05/13/heartDisease/output_9_0.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将categorical variables 变为 dummy variables</span></div><div class="line">a = pd.get_dummies(data[<span class="string">"cp"</span>], prefix = <span class="string">'cp'</span>)</div><div class="line">b = pd.get_dummies(data[<span class="string">"restecg"</span>], prefix = <span class="string">'restecg'</span>)</div><div class="line">c = pd.get_dummies(data[<span class="string">"ca"</span>], prefix = <span class="string">'ca'</span>)</div><div class="line">d = pd.get_dummies(data[<span class="string">"thal"</span>], prefix = <span class="string">'thal'</span>)</div><div class="line">e = pd.get_dummies(data[<span class="string">"slope"</span>], prefix = <span class="string">'slope'</span>)</div></pre></td></tr></table></figure>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将上一步产生的哑变量加入数据集</span></div><div class="line">data = pd.concat([data,a,b,c,d,e], axis = <span class="number">1</span>)</div><div class="line">data.head()</div></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>age</th><br>      <th>sex</th><br>      <th>cp</th><br>      <th>trestbps</th><br>      <th>chol</th><br>      <th>fbs</th><br>      <th>restecg</th><br>      <th>thalach</th><br>      <th>exang</th><br>      <th>oldpeak</th><br>      <th>…</th><br>      <th>ca_2</th><br>      <th>ca_3</th><br>      <th>ca_4</th><br>      <th>thal_0</th><br>      <th>thal_1</th><br>      <th>thal_2</th><br>      <th>thal_3</th><br>      <th>slope_0</th><br>      <th>slope_1</th><br>      <th>slope_2</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>63</td><br>      <td>1</td><br>      <td>3</td><br>      <td>145</td><br>      <td>233</td><br>      <td>1</td><br>      <td>0</td><br>      <td>150</td><br>      <td>0</td><br>      <td>2.3</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>37</td><br>      <td>1</td><br>      <td>2</td><br>      <td>130</td><br>      <td>250</td><br>      <td>0</td><br>      <td>1</td><br>      <td>187</td><br>      <td>0</td><br>      <td>3.5</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>41</td><br>      <td>0</td><br>      <td>1</td><br>      <td>130</td><br>      <td>204</td><br>      <td>0</td><br>      <td>0</td><br>      <td>172</td><br>      <td>0</td><br>      <td>1.4</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>56</td><br>      <td>1</td><br>      <td>1</td><br>      <td>120</td><br>      <td>236</td><br>      <td>0</td><br>      <td>1</td><br>      <td>178</td><br>      <td>0</td><br>      <td>0.8</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>57</td><br>      <td>0</td><br>      <td>0</td><br>      <td>120</td><br>      <td>354</td><br>      <td>0</td><br>      <td>1</td><br>      <td>163</td><br>      <td>1</td><br>      <td>0.6</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows × 33 columns</p><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将原始的变量删去</span></div><div class="line">data = data.drop(columns=[<span class="string">'cp'</span>, <span class="string">'restecg'</span>, <span class="string">'thal'</span>,<span class="string">'ca'</span>,<span class="string">'slope'</span>])</div><div class="line">data.head()</div></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>age</th><br>      <th>sex</th><br>      <th>trestbps</th><br>      <th>chol</th><br>      <th>fbs</th><br>      <th>thalach</th><br>      <th>exang</th><br>      <th>oldpeak</th><br>      <th>target</th><br>      <th>cp_0</th><br>      <th>…</th><br>      <th>ca_2</th><br>      <th>ca_3</th><br>      <th>ca_4</th><br>      <th>thal_0</th><br>      <th>thal_1</th><br>      <th>thal_2</th><br>      <th>thal_3</th><br>      <th>slope_0</th><br>      <th>slope_1</th><br>      <th>slope_2</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>63</td><br>      <td>1</td><br>      <td>145</td><br>      <td>233</td><br>      <td>1</td><br>      <td>150</td><br>      <td>0</td><br>      <td>2.3</td><br>      <td>1</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>37</td><br>      <td>1</td><br>      <td>130</td><br>      <td>250</td><br>      <td>0</td><br>      <td>187</td><br>      <td>0</td><br>      <td>3.5</td><br>      <td>1</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>41</td><br>      <td>0</td><br>      <td>130</td><br>      <td>204</td><br>      <td>0</td><br>      <td>172</td><br>      <td>0</td><br>      <td>1.4</td><br>      <td>1</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>56</td><br>      <td>1</td><br>      <td>120</td><br>      <td>236</td><br>      <td>0</td><br>      <td>178</td><br>      <td>0</td><br>      <td>0.8</td><br>      <td>1</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>57</td><br>      <td>0</td><br>      <td>120</td><br>      <td>354</td><br>      <td>0</td><br>      <td>163</td><br>      <td>1</td><br>      <td>0.6</td><br>      <td>1</td><br>      <td>1</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows × 28 columns</p><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将决策变量取出</span></div><div class="line">x = data.drop(<span class="string">'target'</span>, axis = <span class="number">1</span>)</div><div class="line">x.head()</div></pre></td></tr></table></figure>
<div><br><style scoped><br>    .dataframe tbody tr th:only-of-type {<br>        vertical-align: middle;<br>    }<br><br>    .dataframe tbody tr th {<br>        vertical-align: top;<br>    }<br><br>    .dataframe thead th {<br>        text-align: right;<br>    }<br></style><br><table border="1" class="dataframe"><br>  <thead><br>    <tr style="text-align: right;"><br>      <th></th><br>      <th>age</th><br>      <th>sex</th><br>      <th>trestbps</th><br>      <th>chol</th><br>      <th>fbs</th><br>      <th>thalach</th><br>      <th>exang</th><br>      <th>oldpeak</th><br>      <th>cp_0</th><br>      <th>cp_1</th><br>      <th>…</th><br>      <th>ca_2</th><br>      <th>ca_3</th><br>      <th>ca_4</th><br>      <th>thal_0</th><br>      <th>thal_1</th><br>      <th>thal_2</th><br>      <th>thal_3</th><br>      <th>slope_0</th><br>      <th>slope_1</th><br>      <th>slope_2</th><br>    </tr><br>  </thead><br>  <tbody><br>    <tr><br>      <th>0</th><br>      <td>63</td><br>      <td>1</td><br>      <td>145</td><br>      <td>233</td><br>      <td>1</td><br>      <td>150</td><br>      <td>0</td><br>      <td>2.3</td><br>      <td>0</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>1</th><br>      <td>37</td><br>      <td>1</td><br>      <td>130</td><br>      <td>250</td><br>      <td>0</td><br>      <td>187</td><br>      <td>0</td><br>      <td>3.5</td><br>      <td>0</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>    </tr><br>    <tr><br>      <th>2</th><br>      <td>41</td><br>      <td>0</td><br>      <td>130</td><br>      <td>204</td><br>      <td>0</td><br>      <td>172</td><br>      <td>0</td><br>      <td>1.4</td><br>      <td>0</td><br>      <td>1</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>3</th><br>      <td>56</td><br>      <td>1</td><br>      <td>120</td><br>      <td>236</td><br>      <td>0</td><br>      <td>178</td><br>      <td>0</td><br>      <td>0.8</td><br>      <td>0</td><br>      <td>1</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>    <tr><br>      <th>4</th><br>      <td>57</td><br>      <td>0</td><br>      <td>120</td><br>      <td>354</td><br>      <td>0</td><br>      <td>163</td><br>      <td>1</td><br>      <td>0.6</td><br>      <td>1</td><br>      <td>0</td><br>      <td>…</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>      <td>0</td><br>      <td>0</td><br>      <td>0</td><br>      <td>1</td><br>    </tr><br>  </tbody><br></table><br><p>5 rows × 27 columns</p><br></div>




<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">y = data[<span class="string">'target'</span>]</div><div class="line">y.head()</div></pre></td></tr></table></figure>
<pre><code>0    1
1    1
2    1
3    1
4    1
Name: target, dtype: int64
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将数据随机的分为测试组和结果组</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.model_selection <span class="keyword">import</span> train_test_split</div><div class="line">x_train,x_test,y_train,y_test=train_test_split(x,y,test_size=<span class="number">0.2</span>,random_state=<span class="number">0</span>)</div></pre></td></tr></table></figure>
<h2 id="Logistic-Regression"><a href="#Logistic-Regression" class="headerlink" title="Logistic Regression"></a>Logistic Regression</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 产生一个我们要用的分类器</span></div><div class="line"><span class="keyword">from</span> sklearn.linear_model <span class="keyword">import</span> LogisticRegression</div><div class="line">classifier = LogisticRegression(solver = <span class="string">'liblinear'</span>)</div><div class="line"></div><div class="line"><span class="comment"># 放入训练数据</span></div><div class="line">classifier.fit(x_train, y_train)</div><div class="line"></div><div class="line"><span class="comment"># 测试训练器classifier的训练结果</span></div><div class="line">y_pred = classifier.predict(x_test)</div><div class="line"></div><div class="line"><span class="comment"># 产生测试结果,和用模型生成的结果的混肴矩阵</span></div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> confusion_matrix</div><div class="line">cm = confusion_matrix(y_test, y_pred)</div><div class="line">cm</div></pre></td></tr></table></figure>
<pre><code>array([[23,  4],
       [ 3, 31]], dtype=int64)
</code></pre><p>上面的结果显示</p>
<ul>
<li>有23个1类的被正确的预测到了1类，有4个本来是1类的被分到了4类</li>
<li>有3个本来是1类的被分到了2类，有31个属于2类的被正确归类</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 将上述的混淆矩阵转化为标准的DataFrame格式，然后作图展示</span></div><div class="line">sns.heatmap(pd.DataFrame(cm), annot=<span class="keyword">True</span>, cmap=<span class="string">'Reds'</span>)</div><div class="line">plt.pyplot.show()</div></pre></td></tr></table></figure>
<p><img src="/2019/05/13/heartDisease/output_19_0.png" alt=""> </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 输出正确率，精确率，和召回率</span></div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> accuracy_score</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> precision_score</div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> recall_score</div><div class="line"></div><div class="line">print(<span class="string">"Accuracy = "</span>,accuracy_score(y_test,y_pred)*<span class="number">100</span>,<span class="string">"%"</span>)</div><div class="line">print(<span class="string">"Precision = "</span>,precision_score(y_test,y_pred)*<span class="number">100</span>,<span class="string">"%"</span>)</div><div class="line">print(<span class="string">"Recall Score = "</span>,recall_score(y_test,y_pred)*<span class="number">100</span>,<span class="string">"%"</span>)</div></pre></td></tr></table></figure>
<pre><code>Accuracy =  88.52459016393442 %
Precision =  88.57142857142857 %
Recall Score =  91.17647058823529 %
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 计算敏感度和特异度</span></div><div class="line"><span class="comment"># 敏感度高代表漏诊率低</span></div><div class="line"><span class="comment"># 特异度高代表误诊率低</span></div><div class="line"></div><div class="line">sensitivity = cm[<span class="number">1</span>,<span class="number">1</span>]/(cm[<span class="number">1</span>,<span class="number">1</span>] + cm[<span class="number">1</span>,<span class="number">0</span>])</div><div class="line"><span class="keyword">print</span> (<span class="string">"Sensitivity ="</span>,sensitivity)</div><div class="line">specificity= cm[<span class="number">0</span>,<span class="number">0</span>]/(cm[<span class="number">0</span>,<span class="number">0</span>] + cm[<span class="number">0</span>,<span class="number">1</span>])</div><div class="line">print(<span class="string">"Specificity ="</span>,specificity)</div></pre></td></tr></table></figure>
<pre><code>Sensitivity = 0.9117647058823529
Specificity = 0.8518518518518519
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="comment"># 计算AUC得分，绘制AUC曲线</span></div><div class="line"></div><div class="line"><span class="keyword">from</span> sklearn.metrics <span class="keyword">import</span> roc_auc_score, roc_curve</div><div class="line">auc=roc_auc_score(y_test,y_pred)</div><div class="line">auc</div></pre></td></tr></table></figure>
<pre><code>0.8818082788671023
</code></pre><figure class="highlight python"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">fpr,tpr,thresholds= roc_curve(y_test,y_pred)</div><div class="line">plt.pyplot.plot([<span class="number">0</span>,<span class="number">1</span>],[<span class="number">0</span>,<span class="number">1</span>],linestyle=<span class="string">"--"</span>)</div><div class="line">plt.pyplot.plot(fpr,tpr,marker=<span class="string">"."</span>)</div><div class="line">plt.pyplot.xlabel(<span class="string">"False Positive Rate"</span>)</div><div class="line">plt.pyplot.ylabel(<span class="string">"TruePositive Rate"</span>)</div><div class="line">plt.pyplot.title(<span class="string">"ROC Curve"</span>)</div><div class="line">plt.pyplot.show()</div></pre></td></tr></table></figure>
<p><img src="/2019/05/13/heartDisease/output_23_0.png" alt=""> </p>
<p>用逻辑回归的的效果还是不错的</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://cprocc.github.io/2019/05/13/heartDisease/" data-id="cjvmenuod003q80vldm1j7lf7" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/DataScience/">DataScience</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Kaggle/">Kaggle</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Logistics-Regression/">Logistics Regression</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/python/">python</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/2019/05/07/BackTracking/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">leetcode-BackTracking算法例题</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/">leetcode</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/python/">python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/leetcode/python/算法/">算法</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/numpy/">numpy</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/numpy/python/">python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/numpy/python/DataScience/">DataScience</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/pandas/">pandas</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/pandas/python/">python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/pandas/python/DataScience/">DataScience</a></li></ul></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/python/">python</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/python/DateScience/">DateScience</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/python数据格式转换/">python数据格式转换</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/python数据格式转换/二级目录/">二级目录</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/日志/">日志</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/日志/二级目录/">二级目录</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/日志/计算机科学/">计算机科学</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/">爬虫</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/Nutch1-1搭建/">Nutch1.1搭建</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/爬虫/Nutch搭建/">Nutch搭建</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活/">生活</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/生活/杂想/">杂想</a></li></ul></li><li class="category-list-item"><a class="category-list-link" href="/categories/语法/">语法</a><ul class="category-list-child"><li class="category-list-item"><a class="category-list-link" href="/categories/语法/python/">python</a></li></ul></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/DataScience/">DataScience</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Git/">Git</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP协议/">HTTP协议</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/JSP/">JSP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Kaggle/">Kaggle</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Logistics-Regression/">Logistics Regression</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Nutch/">Nutch</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hello/">hello</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/jsp/">jsp</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/leetcode/">leetcode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/maven/">maven</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/python/">python</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/spring/">spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/构造数据抽象/">构造数据抽象</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/构造过程抽象/">构造过程抽象</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/记录/">记录</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/DataScience/" style="font-size: 10px;">DataScience</a> <a href="/tags/Git/" style="font-size: 10px;">Git</a> <a href="/tags/HTTP协议/" style="font-size: 10px;">HTTP协议</a> <a href="/tags/JSP/" style="font-size: 15px;">JSP</a> <a href="/tags/Kaggle/" style="font-size: 10px;">Kaggle</a> <a href="/tags/Logistics-Regression/" style="font-size: 10px;">Logistics Regression</a> <a href="/tags/Nutch/" style="font-size: 15px;">Nutch</a> <a href="/tags/hello/" style="font-size: 10px;">hello</a> <a href="/tags/hexo/" style="font-size: 15px;">hexo</a> <a href="/tags/jsp/" style="font-size: 10px;">jsp</a> <a href="/tags/leetcode/" style="font-size: 15px;">leetcode</a> <a href="/tags/maven/" style="font-size: 10px;">maven</a> <a href="/tags/python/" style="font-size: 20px;">python</a> <a href="/tags/spring/" style="font-size: 10px;">spring</a> <a href="/tags/构造数据抽象/" style="font-size: 10px;">构造数据抽象</a> <a href="/tags/构造过程抽象/" style="font-size: 10px;">构造过程抽象</a> <a href="/tags/记录/" style="font-size: 15px;">记录</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/05/">May 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/04/">April 2019</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/09/">September 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/08/">August 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/06/">June 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/05/13/heartDisease/">逻辑回归</a>
          </li>
        
          <li>
            <a href="/2019/05/07/BackTracking/">leetcode-BackTracking算法例题</a>
          </li>
        
          <li>
            <a href="/2019/04/07/contest131/">leetcode-Contest-131</a>
          </li>
        
          <li>
            <a href="/2019/04/06/pandas入门/">pandas入门</a>
          </li>
        
          <li>
            <a href="/2019/04/06/NumPy基础/">numpy入门</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 zxc<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>